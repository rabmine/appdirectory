Calendar=function(e,c,f,a){this.activeDiv=null;this.currentDateEl=null;this.checkDisabled=null;this.timeout=null;this.onSelected=f||null;this.onClose=a||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT.DEF_DATE_FORMAT;this.ttDateFormat=Calendar._TT.TT_DATE_FORMAT;this.isPopup=true;this.weekNumbers=true;this.mondayFirst=e;this.dateStr=c;this.ar_days=null;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(!Calendar._DN3){var b=new Array();for(var d=8;d>0;){b[--d]=Calendar._DN[d].substr(0,3)}Calendar._DN3=b;b=new Array();for(var d=12;d>0;){b[--d]=Calendar._MN[d].substr(0,3)}Calendar._MN3=b}};Calendar._C=null;Calendar.is_ie=(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent));Calendar._DN3=null;Calendar._MN3=null;Calendar.getAbsolutePos=function(b){var c={x:b.offsetLeft,y:b.offsetTop};if(b.offsetParent){var a=Calendar.getAbsolutePos(b.offsetParent);c.x+=a.x;c.y+=a.y}return c};Calendar.isRelated=function(c,a){var d=a.relatedTarget;if(!d){var b=a.type;if(b=="mouseover"){d=a.fromElement}else{if(b=="mouseout"){d=a.toElement}}}while(d){if(d==c){return true}d=d.parentNode}return false};Calendar.removeClass=function(e,d){if(!(e&&e.className)){return}var a=e.className.split(" ");var b=new Array();for(var c=a.length;c>0;){if(a[--c]!=d){b[b.length]=a[c]}}e.className=b.join(" ")};Calendar.addClass=function(b,a){Calendar.removeClass(b,a);b.className+=" "+a};Calendar.getElement=function(a){if(Calendar.is_ie){return window.event.srcElement}else{return a.currentTarget}};Calendar.getTargetElement=function(a){if(Calendar.is_ie){return window.event.srcElement}else{return a.target}};Calendar.stopEvent=function(a){if(Calendar.is_ie){window.event.cancelBubble=true;window.event.returnValue=false}else{a.preventDefault();a.stopPropagation()}return false};Calendar.addEvent=function(a,c,b){if(a.attachEvent){a.attachEvent("on"+c,b)}else{if(a.addEventListener){a.addEventListener(c,b,true)}else{a["on"+c]=b}}};Calendar.removeEvent=function(a,c,b){if(a.detachEvent){a.detachEvent("on"+c,b)}else{if(a.removeEventListener){a.removeEventListener(c,b,true)}else{a["on"+c]=null}}};Calendar.createElement=function(c,b){var a=null;if(document.createElementNS){a=document.createElementNS("http://www.w3.org/1999/xhtml",c)}else{a=document.createElement(c)}if(typeof b!="undefined"){b.appendChild(a)}return a};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true)}}};Calendar.findMonth=function(a){if(typeof a.month!="undefined"){return a}else{if(typeof a.parentNode.month!="undefined"){return a.parentNode}}return null};Calendar.findYear=function(a){if(typeof a.year!="undefined"){return a}else{if(typeof a.parentNode.year!="undefined"){return a.parentNode}}return null};Calendar.showMonthsCombo=function(){var c=Calendar._C;if(!c){return false}var c=c;var d=c.activeDiv;var b=c.monthsCombo;if(c.hilitedMonth){Calendar.removeClass(c.hilitedMonth,"hilite")}if(c.activeMonth){Calendar.removeClass(c.activeMonth,"active")}var a=c.monthsCombo.getElementsByTagName("div")[c.date.getMonth()];Calendar.addClass(a,"active");c.activeMonth=a;b.style.left=d.offsetLeft+"px";b.style.top=(d.offsetTop+d.offsetHeight)+"px";b.style.display="block"};Calendar.showYearsCombo=function(c){var e=Calendar._C;if(!e){return false}var e=e;var g=e.activeDiv;var h=e.yearsCombo;if(e.hilitedYear){Calendar.removeClass(e.hilitedYear,"hilite")}if(e.activeYear){Calendar.removeClass(e.activeYear,"active")}e.activeYear=null;var f=e.date.getFullYear()+(c?1:-1);var d=h.firstChild;var a=false;for(var b=12;b>0;--b){if(f>=e.minYear&&f<=e.maxYear){d.firstChild.data=f;d.year=f;d.style.display="block";a=true}else{d.style.display="none"}d=d.nextSibling;f+=c?2:-2}if(a){h.style.left=g.offsetLeft+"px";h.style.top=(g.offsetTop+g.offsetHeight)+"px";h.style.display="block"}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal){return false}if(cal.timeout){clearTimeout(cal.timeout)}var el=cal.activeDiv;if(!el){return false}var target=Calendar.getTargetElement(ev);Calendar.removeClass(el,"active");if(target==el||target.parentNode==el){Calendar.cellClick(el)}var mon=Calendar.findMonth(target);var date=null;if(mon){date=new Date(cal.date);if(mon.month!=date.getMonth()){date.setMonth(mon.month);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}else{var year=Calendar.findYear(target);if(year){date=new Date(cal.date);if(year.year!=date.getFullYear()){date.setFullYear(year.year);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev)}};Calendar.tableMouseOver=function(d){var f=Calendar._C;if(!f){return}var c=f.activeDiv;var e=Calendar.getTargetElement(d);if(e==c||e.parentNode==c){Calendar.addClass(c,"hilite active");Calendar.addClass(c.parentNode,"rowhilite")}else{Calendar.removeClass(c,"active");Calendar.removeClass(c,"hilite");Calendar.removeClass(c.parentNode,"rowhilite")}var b=Calendar.findMonth(e);if(b){if(b.month!=f.date.getMonth()){if(f.hilitedMonth){Calendar.removeClass(f.hilitedMonth,"hilite")}Calendar.addClass(b,"hilite");f.hilitedMonth=b}else{if(f.hilitedMonth){Calendar.removeClass(f.hilitedMonth,"hilite")}}}else{var a=Calendar.findYear(e);if(a){if(a.year!=f.date.getFullYear()){if(f.hilitedYear){Calendar.removeClass(f.hilitedYear,"hilite")}Calendar.addClass(a,"hilite");f.hilitedYear=a}else{if(f.hilitedYear){Calendar.removeClass(f.hilitedYear,"hilite")}}}}return Calendar.stopEvent(d)};Calendar.tableMouseDown=function(a){if(Calendar.getTargetElement(a)==Calendar.getElement(a)){return Calendar.stopEvent(a)}};Calendar.calDragIt=function(b){var c=Calendar._C;if(!(c&&c.dragging)){return false}var e;var d;if(Calendar.is_ie){d=window.event.clientY+document.body.scrollTop;e=window.event.clientX+document.body.scrollLeft}else{e=b.pageX;d=b.pageY}c.hideShowCovered();var a=c.element.style;a.left=(e-c.xOffs)+"px";a.top=(d-c.yOffs)+"px";return Calendar.stopEvent(b)};Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal){return false}cal.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseover",stopEvent);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev)}cal.hideShowCovered()};Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el.disabled){return false}var cal=el.calendar;cal.activeDiv=el;Calendar._C=cal;if(el.navtype!=300){with(Calendar){addClass(el,"hilite active");addEvent(document,"mouseover",tableMouseOver);addEvent(document,"mousemove",tableMouseOver);addEvent(document,"mouseup",tableMouseUp)}}else{if(cal.isPopup){cal._dragStart(ev)}}if(el.navtype==-1||el.navtype==1){cal.timeout=setTimeout("Calendar.showMonthsCombo()",250)}else{if(el.navtype==-2||el.navtype==2){cal.timeout=setTimeout((el.navtype>0)?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250)}else{cal.timeout=null}}return Calendar.stopEvent(ev)};Calendar.dayMouseDblClick=function(a){Calendar.cellClick(Calendar.getElement(a));if(Calendar.is_ie){document.selection.empty()}};Calendar.dayMouseOver=function(ev){var el=Calendar.getElement(ev);if(Calendar.isRelated(el,ev)||Calendar._C||el.disabled){return false}if(el.ttip){if(el.ttip.substr(0,1)=="_"){var date=null;with(el.calendar.date){date=new Date(getFullYear(),getMonth(),el.caldate)}el.ttip=date.print(el.calendar.ttDateFormat)+el.ttip.substr(1)}el.calendar.tooltips.firstChild.data=el.ttip}if(el.navtype!=300){Calendar.addClass(el,"hilite");if(el.caldate){Calendar.addClass(el.parentNode,"rowhilite")}}return Calendar.stopEvent(ev)};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||el.disabled){return false}removeClass(el,"hilite");if(el.caldate){removeClass(el.parentNode,"rowhilite")}el.calendar.tooltips.firstChild.data=_TT.SEL_DATE;return stopEvent(ev)}};Calendar.cellClick=function(f){var g=f.calendar;var c=false;var b=false;var a=null;if(typeof f.navtype=="undefined"){Calendar.removeClass(g.currentDateEl,"selected");Calendar.addClass(f,"selected");c=(g.currentDateEl==f);if(!c){g.currentDateEl=f}g.date.setDate(f.caldate);a=g.date;b=true;g.dateClicked=true}else{if(f.navtype==200){Calendar.removeClass(f,"hilite");g.callCloseHandler();return}a=(f.navtype==0)?new Date():new Date(g.date);g.dateClicked=(f.navtype==0);var e=a.getFullYear();var d=a.getMonth();function h(j){var k=a.getDate();var i=a.getMonthDays(j);if(k>i){a.setDate(i)}a.setMonth(j)}switch(f.navtype){case -2:if(e>g.minYear){a.setFullYear(e-1)}break;case -1:if(d>0){h(d-1)}else{if(e-->g.minYear){a.setFullYear(e);h(11)}}break;case 1:if(d<11){h(d+1)}else{if(e<g.maxYear){a.setFullYear(e+1);h(0)}}break;case 2:if(e<g.maxYear){a.setFullYear(e+1)}break;case 100:g.setMondayFirst(!g.mondayFirst);return;case 0:if((typeof g.checkDisabled=="function")&&g.checkDisabled(a)){return false}break}if(!a.equalsTo(g.date)){g.setDate(a);b=true}}if(b){g.callHandler()}if(c){Calendar.removeClass(f,"hilite");g.callCloseHandler()}};Calendar.prototype.create=function(n){var m=null;if(!n){m=document.getElementsByTagName("body")[0];this.isPopup=true}else{m=n;this.isPopup=false}this.date=this.dateStr?new Date(this.dateStr):new Date();var q=Calendar.createElement("table");this.table=q;q.cellSpacing=0;q.cellPadding=0;q.calendar=this;Calendar.addEvent(q,"mousedown",Calendar.tableMouseDown);var a=Calendar.createElement("div");this.element=a;a.className="calendar";if(this.isPopup){a.style.position="absolute";a.style.display="none"}a.appendChild(q);var k=Calendar.createElement("thead",q);var o=null;var r=null;var b=this;var e=function(s,j,i){o=Calendar.createElement("td",r);o.colSpan=j;o.className="button";Calendar._add_evs(o);o.calendar=b;o.navtype=i;if(s.substr(0,1)!="&"){o.appendChild(document.createTextNode(s))}else{o.innerHTML=s}return o};r=Calendar.createElement("tr",k);var c=6;(this.isPopup)&&--c;(this.weekNumbers)&&++c;e("-",1,100).ttip=Calendar._TT.TOGGLE;this.title=e("",c,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT.DRAG_TO_MOVE;this.title.style.cursor="move";e("&#x00d7;",1,200).ttip=Calendar._TT.CLOSE}r=Calendar.createElement("tr",k);r.className="headrow";this._nav_py=e("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT.PREV_YEAR;this._nav_pm=e("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT.PREV_MONTH;this._nav_now=e(Calendar._TT.TODAY,this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT.GO_TODAY;this._nav_nm=e("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT.NEXT_MONTH;this._nav_ny=e("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT.NEXT_YEAR;r=Calendar.createElement("tr",k);r.className="daynames";if(this.weekNumbers){o=Calendar.createElement("td",r);o.className="name wn";o.appendChild(document.createTextNode(Calendar._TT.WK))}for(var h=7;h>0;--h){o=Calendar.createElement("td",r);o.appendChild(document.createTextNode(""));if(!h){o.navtype=100;o.calendar=this;Calendar._add_evs(o)}}this.firstdayname=(this.weekNumbers)?r.firstChild.nextSibling:r.firstChild;this._displayWeekdays();var g=Calendar.createElement("tbody",q);this.tbody=g;for(h=6;h>0;--h){r=Calendar.createElement("tr",g);if(this.weekNumbers){o=Calendar.createElement("td",r);o.appendChild(document.createTextNode(""))}for(var f=7;f>0;--f){o=Calendar.createElement("td",r);o.appendChild(document.createTextNode(""));o.calendar=this;Calendar._add_evs(o)}}var l=Calendar.createElement("tfoot",q);r=Calendar.createElement("tr",l);r.className="footrow";o=e(Calendar._TT.SEL_DATE,this.weekNumbers?8:7,300);o.className="ttip";if(this.isPopup){o.ttip=Calendar._TT.DRAG_TO_MOVE;o.style.cursor="move"}this.tooltips=o;a=Calendar.createElement("div",this.element);this.monthsCombo=a;a.className="combo";for(h=0;h<Calendar._MN.length;++h){var d=Calendar.createElement("div");d.className="label";d.month=h;d.appendChild(document.createTextNode(Calendar._MN3[h]));a.appendChild(d)}a=Calendar.createElement("div",this.element);this.yearsCombo=a;a.className="combo";for(h=12;h>0;--h){var p=Calendar.createElement("div");p.className="label";p.appendChild(document.createTextNode(""));a.appendChild(p)}this._init(this.mondayFirst,this.date);m.appendChild(this.element)};Calendar._keyEvent=function(e){if(!window.calendar){return false}(Calendar.is_ie)&&(e=window.event);var g=window.calendar;var a=(Calendar.is_ie||e.type=="keypress");if(e.ctrlKey){switch(e.keyCode){case 37:a&&Calendar.cellClick(g._nav_pm);break;case 38:a&&Calendar.cellClick(g._nav_py);break;case 39:a&&Calendar.cellClick(g._nav_nm);break;case 40:a&&Calendar.cellClick(g._nav_ny);break;default:return false}}else{switch(e.keyCode){case 32:Calendar.cellClick(g._nav_now);break;case 27:a&&g.hide();break;case 37:case 38:case 39:case 40:if(a){var b=g.date.getDate()-1;var c=g.currentDateEl;var f=null;var d=(e.keyCode==37)||(e.keyCode==38);switch(e.keyCode){case 37:(--b>=0)&&(f=g.ar_days[b]);break;case 38:b-=7;(b>=0)&&(f=g.ar_days[b]);break;case 39:(++b<g.ar_days.length)&&(f=g.ar_days[b]);break;case 40:b+=7;(b<g.ar_days.length)&&(f=g.ar_days[b]);break}if(!f){if(d){Calendar.cellClick(g._nav_pm)}else{Calendar.cellClick(g._nav_nm)}b=(d)?g.date.getMonthDays():1;c=g.currentDateEl;f=g.ar_days[b-1]}Calendar.removeClass(c,"selected");Calendar.addClass(f,"selected");g.date.setDate(f.caldate);g.callHandler();g.currentDateEl=f}break;case 13:if(a){g.callHandler();g.hide()}break;default:return false}}return Calendar.stopEvent(e)};Calendar.prototype._init=function(f,t){var r=new Date();var h=t.getFullYear();if(h<this.minYear){h=this.minYear;t.setFullYear(h)}else{if(h>this.maxYear){h=this.maxYear;t.setFullYear(h)}}this.mondayFirst=f;this.date=new Date(t);var u=t.getMonth();var w=t.getDate();var v=t.getMonthDays();t.setDate(1);var k=t.getDay();var q=f?1:0;var c=f?5:6;var b=f?6:0;if(f){k=(k>0)?(k-1):6}var g=1;var d=this.tbody.firstChild;var l=Calendar._MN3[u];var e=((r.getFullYear()==h)&&(r.getMonth()==u));var s=r.getDate();var m=t.getWeekNumber();var n=new Array();for(var p=0;p<6;++p){if(g>v){d.className="emptyrow";d=d.nextSibling;continue}var a=d.firstChild;if(this.weekNumbers){a.className="day wn";a.firstChild.data=m;a=a.nextSibling}++m;d.className="daysrow";for(var o=0;o<7;++o){a.className="day";if((!p&&o<k)||g>v){a.innerHTML="&nbsp;";a.disabled=true;a=a.nextSibling;continue}a.disabled=false;a.firstChild.data=g;if(typeof this.checkDisabled=="function"){t.setDate(g);if(this.checkDisabled(t)){a.className+=" disabled";a.disabled=true}}if(!a.disabled){n[n.length]=a;a.caldate=g;a.ttip="_";if(g==w){a.className+=" selected";this.currentDateEl=a}if(e&&(g==s)){a.className+=" today";a.ttip+=Calendar._TT.PART_TODAY}if(k==c||k==b){a.className+=" weekend"}}++g;((++k)^7)||(k=0);a=a.nextSibling}d=d.nextSibling}this.ar_days=n;this.title.firstChild.data=Calendar._MN[u]+", "+h};Calendar.prototype.setDate=function(a){if(!a.equalsTo(this.date)){this._init(this.mondayFirst,a)}};Calendar.prototype.refresh=function(){this._init(this.mondayFirst,this.date)};Calendar.prototype.setMondayFirst=function(a){this._init(a,this.date);this._displayWeekdays()};Calendar.prototype.setDisabledHandler=function(a){this.checkDisabled=a};Calendar.prototype.setRange=function(b,c){this.minYear=b;this.maxYear=c};Calendar.prototype.callHandler=function(){if(this.onSelected){this.onSelected(this,this.date.print(this.dateFormat))}};Calendar.prototype.callCloseHandler=function(){if(this.onClose){this.onClose(this)}this.hideShowCovered()};Calendar.prototype.destroy=function(){var a=this.element.parentNode;a.removeChild(this.element);Calendar._C=null};Calendar.prototype.reparent=function(b){var a=this.element;a.parentNode.removeChild(a);b.appendChild(a)};Calendar._checkCalendar=function(b){if(!window.calendar){return false}var a=Calendar.is_ie?Calendar.getElement(b):Calendar.getTargetElement(b);for(;a!=null&&a!=calendar.element;a=a.parentNode){}if(a==null){window.calendar.callCloseHandler();return Calendar.stopEvent(b)}};Calendar.prototype.show=function(){var e=this.table.getElementsByTagName("tr");for(var d=e.length;d>0;){var f=e[--d];Calendar.removeClass(f,"rowhilite");var c=f.getElementsByTagName("td");for(var b=c.length;b>0;){var a=c[--b];Calendar.removeClass(a,"hilite");Calendar.removeClass(a,"active")}}this.element.style.display="block";this.hidden=false;if(this.isPopup){window.calendar=this;Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"keypress",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar)}this.hideShowCovered()};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"keypress",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar)}this.element.style.display="none";this.hidden=true;this.hideShowCovered()};Calendar.prototype.showAt=function(a,c){var b=this.element.style;b.left=a+"px";b.top=c+"px";this.show()};Calendar.prototype.showAtElement=function(d,e){var g=Calendar.getAbsolutePos(d);if(!e||typeof e!="string"){this.showAt(g.x,g.y+d.offsetHeight);return true}this.show();var a=this.element.offsetWidth;var c=this.element.offsetHeight;this.hide();var b=e.substr(0,1);var f="l";if(e.length>1){f=e.substr(1,1)}switch(b){case"T":g.y-=c;break;case"B":g.y+=d.offsetHeight;break;case"C":g.y+=(d.offsetHeight-c)/2;break;case"t":g.y+=d.offsetHeight-c;break;case"b":break}switch(f){case"L":g.x-=a;break;case"R":g.x+=d.offsetWidth;break;case"C":g.x+=(d.offsetWidth-a)/2;break;case"r":g.x+=d.offsetWidth-a;break;case"l":break}this.showAt(g.x,g.y)};Calendar.prototype.setDateFormat=function(a){this.dateFormat=a};Calendar.prototype.setTtDateFormat=function(a){this.ttDateFormat=a};Calendar.prototype.parseDate=function(l,c){var n=0;var e=-1;var h=0;var p=l.split(/\W+/);if(!c){c=this.dateFormat}var o=c.split(/\W+/);var g=0,f=0;for(g=0;g<p.length;++g){if(o[g]=="D"||o[g]=="DD"){continue}if(o[g]=="d"||o[g]=="dd"){h=parseInt(p[g],10)}if(o[g]=="m"||o[g]=="mm"){e=parseInt(p[g],10)-1}if((o[g]=="y")||(o[g]=="yy")){n=parseInt(p[g],10);(n<100)&&(n+=(n>29)?1900:2000)}if(o[g]=="M"||o[g]=="MM"){for(f=0;f<12;++f){if(Calendar._MN[f].substr(0,p[g].length).toLowerCase()==p[g].toLowerCase()){e=f;break}}}}if(n!=0&&e!=-1&&h!=0){this.setDate(new Date(n,e,h));return}n=0;e=-1;h=0;for(g=0;g<p.length;++g){if(p[g].search(/[a-zA-Z]+/)!=-1){var q=-1;for(f=0;f<12;++f){if(Calendar._MN[f].substr(0,p[g].length).toLowerCase()==p[g].toLowerCase()){q=f;break}}if(q!=-1){if(e!=-1){h=e+1}e=q}}else{if(parseInt(p[g],10)<=12&&e==-1){e=p[g]-1}else{if(parseInt(p[g],10)>31&&n==0){n=parseInt(p[g],10);(n<100)&&(n+=(n>29)?1900:2000)}else{if(h==0){h=p[g]}}}}}if(n==0){var k=new Date();n=k.getFullYear()}if(e!=-1&&h!=0){this.setDate(new Date(n,e,h))}};Calendar.prototype.hideShowCovered=function(){function o(p,i){var k=p.style[i];if(!k){if(document.defaultView&&typeof(document.defaultView.getComputedStyle)=="function"){k=document.defaultView.getComputedStyle(p,"").getPropertyValue(i)}else{if(p.currentStyle){k=p.currentStyle[i]}else{k=p.style[i]}}}return k}var s=new Array("applet","iframe","select");var b=this.element;var a=Calendar.getAbsolutePos(b);var e=a.x;var c=b.offsetWidth+e;var r=a.y;var q=b.offsetHeight+r;for(var g=s.length;g>0;){var f=document.getElementsByTagName(s[--g]);var d=null;for(var j=f.length;j>0;){d=f[--j];a=Calendar.getAbsolutePos(d);var n=a.x;var m=d.offsetWidth+n;var l=a.y;var h=d.offsetHeight+l;if(this.hidden||(n>c)||(m<e)||(l>q)||(h<r)){if(!d.__msh_save_visibility){d.__msh_save_visibility=o(d,"visibility")}d.style.visibility=d.__msh_save_visibility}else{if(!d.__msh_save_visibility){d.__msh_save_visibility=o(d,"visibility")}d.style.visibility="hidden"}}}};Calendar.prototype._displayWeekdays=function(){var c=this.mondayFirst?0:1;var b=this.mondayFirst?6:0;var e=this.mondayFirst?5:6;var a=this.firstdayname;for(var d=0;d<7;++d){a.className="day name";if(!d){a.ttip=this.mondayFirst?Calendar._TT.SUN_FIRST:Calendar._TT.MON_FIRST;a.navtype=100;a.calendar=this;Calendar._add_evs(a)}if(d==b||d==e){Calendar.addClass(a,"weekend")}a.firstChild.data=Calendar._DN3[d+1-c];a=a.nextSibling}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none"};Calendar.prototype._dragStart=function(ev){if(this.dragging){return}this.dragging=true;var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft}else{posY=ev.clientY+window.scrollY;posX=ev.clientX+window.scrollX}var st=this.element.style;this.xOffs=posX-parseInt(st.left);this.yOffs=posY-parseInt(st.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseover",stopEvent);addEvent(document,"mouseup",calDragEnd)}};Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1000;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date.prototype.getMonthDays=function(b){var a=this.getFullYear();if(typeof b=="undefined"){b=this.getMonth()}if(((0==(a%4))&&((0!=(a%100))||(0==(a%400))))&&b==1){return 29}else{return Date._MD[b]}};Date.prototype.getWeekNumber=function(){var b=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var d=new Date(this.getFullYear(),0,1,0,0,0);var c=b-d;var a=d.getDay();(a>3)&&(a-=4)||(a+=3);return Math.round(((c/Date.DAY)+a)/7)};Date.prototype.equalsTo=function(a){return((this.getFullYear()==a.getFullYear())&&(this.getMonth()==a.getMonth())&&(this.getDate()==a.getDate()))};Date.prototype.print=function(frm){var str=new String(frm);var m=this.getMonth();var d=this.getDate();var y=this.getFullYear();var wn=this.getWeekNumber();var w=this.getDay();var s=new Array();s.d=d;s.dd=(d<10)?("0"+d):d;s.m=1+m;s.mm=(m<9)?("0"+(1+m)):(1+m);s.y=y;s.yy=new String(y).substr(2,2);s.w=wn;s.ww=(wn<10)?("0"+wn):wn;with(Calendar){s.D=_DN3[w];s.DD=_DN[w];s.M=_MN3[m];s.MM=_MN[m]}var re=/(.*)(\W|^)(d|dd|m|mm|y|yy|MM|M|DD|D|w|ww)(\W|$)(.*)/;while(re.exec(str)!=null){str=RegExp.$1+RegExp.$2+s[RegExp.$3]+RegExp.$4+RegExp.$5}return str};window.calendar=null;